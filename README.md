# ThermMod3D
A 3D thermophysical model for airless planetary bodies, including binary asteroids, solitary bodies and landscapes for which a DEM exists.

NOTICE: THIS PAGE AND REPOSITORY ARE IN PROGRESS AND WILL BE UPDATED SHORTLY

-------------------------------------------------------------------------------------------------------------------------------------------

ThermMod3D utilizes triangulated meshes to calculate temperatures for the surface and near subsurface of airless bodies. It is capable of and has been utilized for:

Single asteroids, such as Bennu, for which a shape model exists
Digital Elevation Models (DEMs) and Digital Terrain Models (DTMs) of topography on airless bodies
3D interacting binary pairs, including eclipses and moonshine.

The model is composed of separate modularized scripts that each are responsible for different components. For example, the shapeModule.py file imports shape models and initializes a "shape" instance. This defines facets, normals, meshes and other properties used by the model later. For single bodies or DEMs, this script reads in one shape model. For the binary implementation, it is also used to move secondary shape models into their orbital location, as most shape models are cemtered at the origin. Specific parameters, such as separation between the primary and secondary, are entered in the planets.py file or can be manually changed when calculating shadows. Other modules include those handling BYORP, orbit information and advancement, ray tracing, etc. Scripts that users will need to interact with are described below.

Planet parameters: Handled by planets.py. For each body that the user is attempting to model, an entry must be made in this file. These entries contain orbital, compositional and other pertinent information. Several entries already exist, and new ones can be added. Users can select a planet in other scripts by defining an instance of the planet class such as planet = planets.Moon. This specific parameters can then be altered in the external script. A planet instance must be fed to the model.
Shadowing Calculation. Users should interact with the preCalculateShadows.py script, as functions are stored in shadowModule.py. For single bodies or DEMs, shadows can be calculated at each timestep as the model runs or pre-calculated. For binary models, it is suggested that users pre-calculate shadowing files. These can be used during equilibration for all runs with a given set of parameters, saving significant computational time. To use, edit the information in lines 31-77 of preCalculateShadows.py. Choose whether you want a single body or binary, enter file paths and select the shadowing resolution you want. Unless specified, obliquity is 0.0 degrees. Though pre-calulation is recommended for binaries, shadowModule.py holds functions used by the model to calculate custom exact shadows at each timestep for the current system geometry. An option has been added that will do this after temperature equilibration to give exact temperatures during readout. This is recommended for any BYORP calculation, as BYORP is very sensitive to changes in temperature and shadow. To enable this, choose calcShadows = True when initializing the model.
View Factor Calculation: Functions for the view factor calculation are contained in visibilityFunction.py, but viewFactorCalculation.py should be edited and run by user. To use, edit lines 55-56 to choose which model you want to run (Single or Binary). Then enter the shape models, file paths for results and (if for a binary system) the number of divisions of the orbit you want to run (labeled steps). View factors will only be calculated once for a single body or DEM. For binary systems, enter the planet as well in order to include the mutual orbit separation. This can also be entered directly. Do not alter the multiprocessing component that follows, unless you want to reduce the number of cores the model runs on. This can be done by switching p = mp.Pool(multiprocessing.cpu_count()) to p = mp.Pool(# of cores).
Model run script. This should be generated by the user. A sample script has been provided for a binary system. A single body model requires a similar but simpler implementation, using the heat3d_Single.py script. Enter the paths for shape models, view factors and shadows, as well as the parameters the model should be run with (described in script). A planet must be selected for each body that will be modeled. Timing is enabled, and will print how long the model takes to run.
For questions on the binary implementation, please see Sorli et al. (2025) (https://doi.org/10.1016/j.icarus.2025.116527). Please direct general questions to to Kya Sorli (kya.sorli@colorado.edu).
